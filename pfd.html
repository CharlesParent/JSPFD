<!DOCTYPE html>
<html>
<head>

</head>
<body style='background-color: white; text-align: center'>
	<canvas id="a" width="1050" height="810"></canvas>
</body>
</html>
<script src="js/jquery-1.11.3.min.js"></script>
<script src="js/elements.js"></script>
<script src="geodesy/latlon-spherical.js"></script>
<script src="js/terrain_data.js"></script>
<script src="js/flightdata.js"></script>

<script src="js/guages/altimeter_ticker.js"></script>
<script src="js/guages/airspeed_ticker.js"></script>
<script src="js/guages/attitude_indicator.js"></script>
<script src="js/guages/vertical_speed.js"></script>
<script src="js/guages/profile_display.js"></script>
<script src="js/guages/horizontal_situation.js"></script>
<script type="text/javascript">

	var GUAGE_BACKGROUND = "#191921";
	var GUAGE_FOREGROUND = "#FFFFFF";
	var BACKGROUND = "#000";
	var GROUND = "#752E00";
	var SKY = "#0072B9";
	var EARTH = "#0B6739"; 
  var BUG = "#F844F8";

	var cvs = document.getElementById("a");
	var ctx = cvs.getContext("2d");

  var data = {}
  var rawData = {};

	guages = []

  function initGuages()
  {
  	guages[0] = new AttitudeIndicator(ctx, 
  	{
  		"width": 400,
  		"height": 325,
  		"x": 223,
  		"y": 180
  	}, 
  	5, // Angle scale in pixels per degree
  	data);

  	// Altimeter digits ticker
  	guages[2] = new AltimeterTicker(ctx, 
  	{
  		"width": 160,
  		"height": 85,
  		"x": 650,
  		"y": 300 
  	}, 
  	data);

  	// Altimeter digits tape
  	guages[1] = new AltimeterTape(ctx, 
  	{
  		"width": 100,
  		"height": 400,
  		"x": guages[2].loc.x + 163,
  		"y": guages[2].loc.y + guages[2].loc.height / 2 - 200
  	}, 
  	data);

  	// Altimeter digits ticker
  	guages[4] = new AirspeedTicker(ctx, 
  	{
  		"width": 80,
  		"height": 85,
  		"x": 100,
  		"y": 300 
  	}, 
  	data);

  	// Altimeter digits tape
  	guages[3] = new AirspeedTape(ctx, 
  	{
  		"width": 75,
  		"height": 400,
  		"x": guages[4].loc.x - 78,
  		"y": guages[4].loc.y + guages[4].loc.height / 2 - 200
  	}, 
  	data);

  	guages[5] = new VerticalSpeedIndicator(ctx, 
  	{
  		"width": 120,
  		"height": 400,
  		"x": 920,
  		"y": guages[1].loc.y + guages[1].loc.height / 2 - 200 
  	}, 
  	33, // font size in pixels
  	data);

  	guages[6] = new ProfileDisplay(ctx, 
  	{
  		"width": 1050,
  		"height": 120,
  		"x": 0,
  		"y": 10 
  	}, 
  	20,  // Horizontal scale in nm for the whole width
  	10, // Terrain resolution in number of steps to draw
  	50,   // Font size in pixels
  	data);

    guages[7] = new HorizontalSituationIndicator(ctx, 
    {
      "width": 675,
      "height": 270,
      "x": 115,
      "y": 525 
    }, 
    40, // Font size in pixels
    data);
  }
  initGuages();

	// Reset Canvas
ctx.fillStyle = BACKGROUND;
ctx.fillRect(0, 0, 1100, 1000);


value = lastValue = 100;
rate = 10

var now = then = delta = new Date().getTime();
var render = function() 
{   
	  now = new Date().getTime();
  	delta = (now - then) / 1000.0;
 		then = now;
 		lastValue = value;
 		value += delta * rate;

 		updateAndDraw();

    // Redraw
    requestAnimationFrame(render);
};

// Start the redrawing process
render();

function updateAndDraw()
{  		
	for (var i = 0; i < guages.length; i++)
		{
  		guages[i].update(data);
  		guages[i].draw();
		}
}


var mousePos = {x: 0, y: 0};
cvs.addEventListener('mousemove', function(evt) 
{
  mousePos = getMousePos(cvs, evt);
}, false);

function getMousePos(canvas, evt) {
      var rect = canvas.getBoundingClientRect();
      return {
        x: evt.clientX - rect.left,
        y: evt.clientY - rect.top
      };
    }
</script>
